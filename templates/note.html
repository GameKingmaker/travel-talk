{% extends "base.html" %}
{% block content %}

<style>
  /* note page only */
  .note-wrap{ max-width:1100px; margin:0 auto; }
  .note-head{
    display:flex; justify-content:space-between; align-items:flex-end; gap:18px;
    margin-bottom:14px;
  }
  .note-head h1{ margin:0; font-size:34px; font-weight:900; letter-spacing:-.02em; }
  .note-head .sub{ margin:8px 0 0; color:#667085; }

  .note-hero{
    display:flex; justify-content:space-between; align-items:stretch; gap:14px;
    background:#fff;
    border:1px solid rgba(37,99,235,.22);
    border-radius:18px;
    padding:16px 16px;
    box-shadow:0 12px 30px rgba(15,23,42,.06);
    margin:10px 0 18px;
  }
  .nh-left{ display:flex; gap:12px; min-width:0; }
  .nh-icon{
    width:44px; height:44px; border-radius:14px;
    display:flex; align-items:center; justify-content:center;
    background:rgba(37,99,235,.10);
    border:1px solid rgba(37,99,235,.18);
    font-size:20px;
    flex:0 0 auto;
  }
  .nh-title{
    font-weight:900; font-size:16px; line-height:1.2; margin-top:2px;
  }
  .nh-pill{
    display:inline-flex; align-items:center; gap:6px;
    padding:5px 10px; border-radius:999px;
    background:rgba(37,99,235,.10);
    border:1px solid rgba(37,99,235,.18);
    color:#1d4ed8;
    font-weight:800; font-size:12px;
    margin-left:8px;
  }
  .nh-desc{ margin:8px 0 0; color:#475569; font-size:13px; line-height:1.55; }
  .nh-desc b{ color:#0f172a; }
  .nh-tip{ margin:6px 0 0; color:#64748b; font-size:12.5px; }

  .nh-actions{
    display:flex; flex-direction:column; gap:10px;
    align-items:flex-end; justify-content:center;
    flex:0 0 auto;
  }
  .nh-actions .btnrow{ display:flex; gap:10px; }
  .nh-actions a{
    text-decoration:none;
  }
  .note-panel{ margin-top:0; }

  .note-section{
    margin-top:18px;
  }
  .note-sec-head{
    display:flex; justify-content:space-between; align-items:center; gap:14px;
    margin:6px 0 12px;
  }
  .note-sec-title{
    margin:0; font-size:18px; font-weight:900;
    display:flex; align-items:center; gap:8px;
  }
  .note-sec-title .count{
    display:inline-flex; align-items:center; justify-content:center;
    min-width:28px; height:22px; padding:0 8px;
    border-radius:999px;
    background:rgba(15,23,42,.06);
    color:#334155; font-weight:900; font-size:12px;
  }

  /* toggle chips */
  .note-toggles{
    display:flex; gap:10px; align-items:center;
    padding:8px 10px;
    background:#fff;
    border:1px solid rgba(15,23,42,.10);
    border-radius:14px;
  }
  .checkline{
    display:flex; align-items:center; gap:8px;
    font-size:13px; color:#334155; font-weight:800;
    cursor:pointer; user-select:none;
  }
  .checkline input{ transform: translateY(0.5px); }

  .note-divider{
    margin:22px 0;
    border:none;
    border-top:1px solid rgba(15,23,42,.08);
  }

  /* empty card */
  .empty{
    background:#fff;
    border:1px dashed rgba(15,23,42,.20);
    border-radius:16px;
    padding:14px 16px;
    color:#64748b;
  }
  .empty b{ color:#0f172a; }
</style>

<div class="note-wrap">

  <!-- âœ… í˜ì´ì§€ í—¤ë” -->
  <div class="note-head">
    <div>
      <h1>ğŸ“ ë‚˜ë§Œì˜ í•™ìŠµë…¸íŠ¸</h1>
      <p class="sub">ì¦ê²¨ì°¾ê¸° ë¬¸ì¥Â·ë‹¨ì–´ë¥¼ í•œ ê³³ì—ì„œ ëª¨ì•„ë³´ê³ , ê°€ë¦¬ê¸°(ë³µìŠµ)ë¡œ ë¹ ë¥´ê²Œ ì ê²€í•´ìš”.</p>
    </div>
  </div>

  <!-- âœ… ì¸íŠ¸ë¡œ ë°•ìŠ¤ -->
  <div class="note-hero">
    <div class="nh-left">
      <div class="nh-icon" aria-hidden="true">ğŸ“’</div>
      <div style="min-width:0;">
        <div class="nh-title">
          ë‚´ê°€ ì €ì¥í•œ í‘œí˜„ì„ ëª¨ì•„ ë³µìŠµí•´ìš”
          <span class="nh-pill">ì¦ê²¨ì°¾ê¸° Â· ë³µìŠµ</span>
        </div>
        <div class="nh-desc">
  <b>ìƒí™©ë³„ íšŒí™”</b> , <b>N5~N1ë¬¸ì¥</b>ì—ì„œ ì €ì¥í•œ ë¬¸ì¥ê³¼ <b>ë‹¨ì–´ ëª¨ìŒ</b> , <b>N5~N1ë‹¨ì–´</b>ì—ì„œ ì €ì¥í•œ ë‹¨ì–´ë¥¼ ì—¬ê¸°ì„œ í•œ ë²ˆì— ê´€ë¦¬í•  ìˆ˜ ìˆì–´ìš”.
  <br>
  ë³µìŠµí•  ë•ŒëŠ” <b>ë°œìŒ/ëœ» ê°€ë¦¬ê¸°</b>ë¡œ ë¹ ë¥´ê²Œ í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”.
</div>
<br>
        <div class="nh-tip">
          Tip: ë¬¸ì¥ê³¼ ë‹¨ì–´ë¥¼ ìµí˜”ë‹¤ë©´ <b>í€´ì¦ˆ ê²Œì„</b>ì—ì„œ í€´ì¦ˆ ë˜ëŠ” ê²Œì„ìœ¼ë¡œ ë°”ë¡œ ì‹¤ë ¥ ì²´í¬í•´ë³´ëŠ” ê²ƒë„ ì¢‹ì•„ìš”.
        </div>
      </div>
    </div>

    <div class="nh-actions">
      <div class="btnrow">
        <a class="btn" href="{{ url_for('quiz') }}">í€´ì¦ˆ ê²Œì„</a>
      </div>
    </div>
  </div>

  <div class="note-panel">

    <!-- âœ… ë¬¸ì¥ ì¦ê²¨ì°¾ê¸° -->
    <div class="note-section">
      <div class="note-sec-head">
        <h2 class="note-sec-title">
          ë¬¸ì¥ ì¦ê²¨ì°¾ê¸°
          <span class="count">{{ fav_items|length if fav_items else 0 }}</span>
        </h2>

        <!-- âœ… í† ê¸€: ë¬¸ì¥ ì¦ê²¨ì°¾ê¸°ì—ì„œë§Œ ì˜ë¯¸ê°€ ìˆìœ¼ë‹ˆ ì—¬ê¸°ë¡œ ì´ë™ -->
        <div class="note-toggles">
          <label class="checkline">
            <input type="checkbox" id="toggle-pron" />
            <span>ë°œìŒ ê°€ë¦¬ê¸°</span>
          </label>
          <label class="checkline">
            <input type="checkbox" id="toggle-ko" />
            <span>ëœ» ê°€ë¦¬ê¸°</span>
          </label>
        </div>
      </div>

      {% if fav_items and fav_items|length > 0 %}
        <section class="phrase-list note-phrase-list" id="noteList">
          {% for item in fav_items %}
            <div class="phrase-card"
                 data-key="{{ item.phrase_key }}"
                 data-jp="{{ item.jp }}"
                 data-pron="{{ item.pron }}"
                 data-ko="{{ item.ko }}">
              <button class="fav-btn on" title="ì¦ê²¨ì°¾ê¸° í•´ì œ">â˜…</button>

              <div class="phrase-body">
                <div class="p-line"><span class="p-label">ì¼ë³¸ì–´:</span> <span class="p-jp">{{ item.jp }}</span></div>
                <div class="p-line"><span class="p-label">ë°œìŒ:</span> <span class="p-pron">{{ item.pron }}</span></div>
                <div class="p-line"><span class="p-label">ëœ»:</span> <span class="p-ko">{{ item.ko }}</span></div>
              </div>

              <button class="speak-btn" data-tts="{{ item.jp }}">ë°œìŒ ë“£ê¸°</button>
            </div>
          {% endfor %}
        </section>
      {% else %}
        <div class="empty">ì•„ì§ ì¦ê²¨ì°¾ê¸°í•œ ë¬¸ì¥ì´ ì—†ìŠµë‹ˆë‹¤. <b>ìƒí™©ë³„ íšŒí™”</b> ë˜ëŠ” <b>Në¬¸ì¥</b>ì—ì„œ â­ ë²„íŠ¼ìœ¼ë¡œ ì €ì¥í•´ë³´ì„¸ìš”.</div>
      {% endif %}
    </div>

    <hr class="note-divider" />

        <!-- âœ… ë‹¨ì–´ ì¦ê²¨ì°¾ê¸° -->
    <div class="note-section">
      <div class="note-sec-head">
        <h2 class="note-sec-title">
          ë‹¨ì–´ ì¦ê²¨ì°¾ê¸°
          <span class="count">{{ word_fav_items|length if word_fav_items else 0 }}</span>
        </h2>
      </div>

      {% if word_fav_items and word_fav_items|length > 0 %}
        <section class="phrase-list" id="wordList">
          {% for w in word_fav_items %}
            <div class="phrase-card" style="align-items:center;"
                 data-cat="{{ w.cat_key }}"
                 data-kanji="{{ (w.kanji or w.jp or '')|e }}"
                 data-kana="{{ (w.kana or '')|e }}"
                 data-pron="{{ (w.pron or '')|e }}"
                 data-ko="{{ (w.ko or '')|e }}">

              <button class="fav-btn on"
                      data-cat="{{ w.cat_key }}"
                      data-jp="{{ (w.kanji or w.jp or '')|e }}"
                      title="ì¦ê²¨ì°¾ê¸° í•´ì œ">â˜…</button>

              <div class="phrase-body">
                <div class="p-line">
                  <span class="p-label">í•œì/í‘œê¸°:</span>
                  <span class="p-jp">{{ w.kanji or w.jp }}</span>
                </div>

                <div class="p-line">
                  <span class="p-label">ê°€ë‚˜:</span>
                  <span class="p-pron">{{ w.kana or "-" }}</span>
                </div>

                <div class="p-line">
                  <span class="p-label">ë°œìŒ:</span>
                  <span class="p-pron">{{ w.pron or "-" }}</span>
                </div>

                <div class="p-line">
                  <span class="p-label">ëœ»:</span>
                  <span class="p-ko">{{ w.ko or "-" }}</span>
                </div>
              </div>

              <button class="speak-btn"
                      data-tts="{{ (w.tts_text or w.kanji or w.kana or w.jp or '')|e }}">
                ë°œìŒ ë“£ê¸°
              </button>
            </div>
          {% endfor %}
        </section>
      {% else %}
        <div class="empty">ì•„ì§ ì¦ê²¨ì°¾ê¸°í•œ ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤. <b>ë‹¨ì–´ ëª¨ìŒ</b> ë˜ëŠ” <b>Në‹¨ì–´</b>ì—ì„œ â˜…ë¡œ ì €ì¥í•´ë³´ì„¸ìš”.</div>
      {% endif %}
    </div>

  </div>
</div>

{% endblock %}
