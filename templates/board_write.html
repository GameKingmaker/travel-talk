{% extends "base.html" %}

{# ✅ 글쓰기 페이지는 검색 노출 필요 없음 #}
{% set page_title = "글쓰기 | 일반게시판 - 일본 여행 회화 공부방" %}
{% set page_desc = "일반게시판 글쓰기 페이지입니다." %}
{% set page_robots = "noindex,nofollow" %}

{% block content %}

<section class="page-head" style="display:flex; align-items:flex-end; justify-content:space-between; gap:16px;">
  <div>
    <h1>글쓰기</h1>
    <p>제목 · 내용 · 이미지(선택)을 입력해 주세요.</p>
  </div>
  <a class="btn" href="{{ url_for('board') }}">취소</a>
</section>

<div class="board-wrap" style="padding:18px;">
  <form method="POST" enctype="multipart/form-data">
    {# CSRF 쓰는 경우에만 활성화 (app.py에서 csrf_token 제공 필요) #}
    {# <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"> #}

    <div style="display:flex; flex-direction:column; gap:14px; max-width:820px;">

      <div>
        <label style="display:block; margin-bottom:6px; font-weight:600;">글 제목</label>
        <input type="text" name="title" value="{{ (form.title if form else '') | e }}" required
               style="width:100%; padding:12px 14px; border-radius:12px; border:1px solid #e5e7eb;">
      </div>

      {# ✅ 관리자만 보이는 공지 체크박스 (템플릿 하드코딩 제거) #}
      {% if user and is_admin(user) %}
        <div style="margin-top:-6px; padding:10px 12px; border:1px solid #e5e7eb; border-radius:12px; background:#fff;">
          <label style="display:flex; gap:10px; align-items:center; font-weight:900;">
            <input type="checkbox" name="is_notice" value="1"
                   {% if form and form.get('is_notice') %}checked{% endif %}>
            📌 공지글로 등록
          </label>
          <div style="margin-top:6px; font-size:12px; color:#667085;">
            관리자만 공지글 작성이 가능합니다.
          </div>
        </div>
      {% endif %}

      <div>
        <label style="display:block; margin-bottom:6px; font-weight:600;">글 내용</label>
        <textarea name="content" rows="10" required
                  style="width:100%; padding:12px 14px; border-radius:12px; border:1px solid #e5e7eb;">{{ (form.content if form else '') | e }}</textarea>
      </div>

      <div>
        <label style="display:block; margin-bottom:6px; font-weight:600;">글 이미지(선택)</label>
        <input type="file" name="image" accept=".png,.jpg,.jpeg,.gif,.webp">
        <div style="margin-top:6px; color:#667085; font-size:13px;">png / jpg / jpeg / gif / webp 업로드 가능</div>
      </div>

      <div style="display:flex; justify-content:flex-end; gap:10px; margin-top:4px;">
        <a class="btn" href="{{ url_for('board') }}">취소</a>
        <button class="btn btn-primary" type="submit">등록</button>
      </div>

    </div>
  </form>
</div>

{% endblock %}
