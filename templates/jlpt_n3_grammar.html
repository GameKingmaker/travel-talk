{% extends "base.html" %}

{% block title %}JLPT N3 문법 | 고급 문법 정리{% endblock %}

{# ✅ JLPT 전용 CSS를 base.html 위에 추가 로드 #}
{% block extra_head %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/jlpt.css') }}">
{% endblock %}

{% block content %}

<!-- ✅ 상단 소개 -->
<div class="jlpt-card jlpt-intro">
  <h2 class="jlpt-intro-title">📚 JLPT N3 문법</h2>
  <p class="jlpt-intro-desc">이 페이지는 JLPT N3 시험을 준비하는 학습자를 위해
일본어의 기본 문법 요소를 정리한 학습 자료입니다.
<br>
    N3 문법은 <b>대조/양보</b>, <b>원인·결과</b>, <b>상황 판단</b>, <b>추측/전언</b>, <b>관용적 표현</b>이 많아져서
    “문장의 뉘앙스”가 점점 중요해집니다. <br>
    아래 분류를 눌러서 필요한 문법만 골라 반복하세요.
  </p>

  <ul class="jlpt-intro-list">
    <li><b>추천 루틴</b>: 문법 2개 → 예문 듣기 → 상황 1줄 암기 → 변형 2개 말해보기</li>
    <li><b>Tip</b>: N3부터는 “뜻”보다 <b>언제 쓰는지(상황)</b>가 기억을 잡아줍니다.</li>
  </ul>

  <p class="jlpt-intro-tip">※ 발음 듣기는 버튼을 누르면 일본어 음성으로 재생됩니다.</p>

  <!-- ✅ 상단 이동 버튼 -->
  <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
    <a class="btn btn-outline" href="{{ url_for('jlpt_n3_home') }}">← N3 홈으로</a>
  </div>
</div>

<!-- ✅ 분류(칩) : N3 추천 11분류 -->
<div class="jlpt-card" style="display:flex; gap:8px; flex-wrap:wrap;">
  <button class="jlpt-chip is-on" type="button" data-filter="all">전체</button>
  <button class="jlpt-chip" type="button" data-filter="contrast">대조/양보</button>
  <button class="jlpt-chip" type="button" data-filter="reason">원인/결과</button>
  <button class="jlpt-chip" type="button" data-filter="judgement">판단/평가</button>
  <button class="jlpt-chip" type="button" data-filter="intention">의지/계획</button>
  <button class="jlpt-chip" type="button" data-filter="guess">추측/전언</button>
  <button class="jlpt-chip" type="button" data-filter="limit">한정/강조</button>
  <button class="jlpt-chip" type="button" data-filter="tendency">습관/경향</button>
  <button class="jlpt-chip" type="button" data-filter="connect">연결/진행</button>
  <button class="jlpt-chip" type="button" data-filter="advice">충고/요구</button>
  <button class="jlpt-chip" type="button" data-filter="time">시간/순서</button>
  <button class="jlpt-chip" type="button" data-filter="condition">조건/가정</button>
</div>

<div class="jlpt-card jlpt-note" style="margin-top:12px;">
  <div style="color:#475569; font-weight:700;">
    🔎 N3는 “문법 = 문장”이 아니라, <b>상황 + 뉘앙스</b>가 핵심입니다.
  </div>
</div>

<!-- =========================
     스타일(페이지 전용) - N4와 동일
========================= -->
<style>
  .g-card{border:1px solid #e5e7eb; border-radius:14px; padding:16px; background:#fff; box-shadow:0 8px 20px rgba(0,0,0,.04); margin-bottom:12px;}
  .g-head{display:flex; align-items:flex-start; justify-content:space-between; gap:10px;}
  .g-title{font-size:18px; font-weight:950; color:#0b1f4b; margin:0;}
  .g-tag{font-size:12px; font-weight:900; color:#334155; background:#f1f5ff; border:1px solid #dbe7ff; padding:6px 10px; border-radius:999px; white-space:nowrap;}
  .g-desc{margin:8px 0 0; color:#374151; line-height:1.7; font-weight:650; font-size:14px;}
  .g-rule{margin:10px 0 0; padding:10px 12px; border:1px dashed #e5e7eb; border-radius:12px; background:#fbfdff; color:#475569; font-size:13px; line-height:1.7;}
  .g-warn{margin:10px 0 0; padding:10px 12px; border-radius:12px; background:#f8fafc; border:1px solid #e5e7eb; color:#475569; font-size:13px; line-height:1.7;}

  .g-extra{margin:12px 0 0; padding:12px 12px; border:1px solid #e5e7eb; border-radius:12px; background:#ffffff;}
  .g-extra .x-row{display:flex; gap:10px; align-items:flex-start; padding:6px 0; border-bottom:1px dashed #eef2f7;}
  .g-extra .x-row:last-child{border-bottom:none;}
  .g-extra .x-k{min-width:60px; font-weight:950; color:#0b1f4b; font-size:13px;}
  .g-extra .x-v{color:#334155; font-weight:750; font-size:13px; line-height:1.7;}
  .x-badge{display:inline-block; margin-right:6px; font-size:12px; font-weight:950; color:#0b1f4b; background:#eef2ff; border:1px solid #dbe7ff; padding:2px 8px; border-radius:999px;}

  .ex{margin-top:12px; padding-top:12px; border-top:1px solid #eef2f7;}
  .ex-row{display:flex; gap:10px; align-items:flex-start; justify-content:space-between; padding:10px 0; border-bottom:1px dashed #eef2f7;}
  .ex-row:last-child{border-bottom:none;}
  .ex-left{flex:1;}
  .ex-jp{font-size:16px; font-weight:900; color:#111827;}
  .ex-pron{margin-top:4px; color:#64748b; font-weight:700; font-size:13px;}
  .ex-ko{margin-top:4px; color:#334155; font-weight:700; font-size:13px;}

  .ex-use{
    margin-top:6px;
    color:#475569;
    font-weight:800;
    font-size:12.5px;
    line-height:1.55;
    background:#f8fafc;
    border:1px solid #e5e7eb;
    padding:6px 10px;
    border-radius:10px;
    display:inline-block;
  }

  .hl{
    display:inline-block;
    padding:1px 6px;
    border-radius:8px;
    border:1px solid #fde68a;
    background:#fffbeb;
    color:#92400e;
    font-weight:950;
    box-shadow:0 2px 8px rgba(0,0,0,.04);
  }

  .tts-btn{
    height:36px; padding:0 12px; border-radius:999px; border:1px solid #dbe7ff;
    background:#f1f5ff; color:#0b1f4b; font-weight:900; font-size:13px; cursor:pointer;
    white-space:nowrap;
  }
  .tts-btn:hover{background:#eaf0ff;}
</style>

<!-- ✅ 문법 카드 출력 -->
<div id="grammarList"></div>

{% endblock %}

{% block extra_scripts %}
<script>
/* ==========================================================
  ✅ N3 문법 데이터(빈출 위주) - 완성판(총 36개)
  - 기존 15개 포함 + 추가 21개
========================================================== */
const grammarData = [
  /* =======================
     contrast: 대조/양보
  ======================= */
  {
    cat:"contrast", tag:"대조/양보", title:"～ても (…해도)",
    desc:"조건이 달라져도 결과는 변하지 않는 양보",
    rule:"동사/い형(て形) + <span class='hl'>も</span> / な형·명사: でも",
    warn:"N3에서 ‘양보’ 대표. 결과가 안 바뀌는 뉘앙스.",
    extra:{
      core:"<span class='x-badge'>양보</span> “~해도(상관없다)”",
      situation:"상대가 걱정/조건을 말해도 ‘괜찮아’라고 할 때",
      breakdown:"高くても(비싸도) + 買います(산다)",
      caution:"‘てもいい’(허가)와 구분: N3 ‘ても’는 양보",
      variation:"忙しくても行きます。／雨でもやります。"
    },
    examples:[
      {jp:"高くても買います。", pron:"타카쿠테모 카이마스", ko:"비싸도 살게요.", use:"✅ 상황: 조건 상관없음", highlight:["ても"]},
      {jp:"雨でも試合はあります。", pron:"아메데모 시아이와 아리마스", ko:"비가 와도 경기는 있어요.", use:"✅ 상황: 행사/일정 고정", highlight:["でも"]},
      {jp:"遅くても大丈夫です。", pron:"오소쿠테모 다이죠오부데스", ko:"늦어도 괜찮아요.", use:"✅ 상황: 상대 안심시키기", highlight:["ても"]}
    ]
  },
  {
    cat:"contrast", tag:"대조/양보", title:"～のに (…인데도)",
    desc:"예상과 반대되는 결과(불만/아쉬움 뉘앙스)",
    rule:"普通形 + <span class='hl'>のに</span>",
    warn:"N3는 감정 뉘앙스까지 잡는 게 포인트.",
    extra:{
      core:"<span class='x-badge'>역접</span> “~인데도”",
      situation:"기대와 다르게 흘러갈 때(아쉬움/불만)",
      breakdown:"頑張った(했는데) + のに + だめだった(안 됐다)",
      caution:"뒤 문장이 ‘원치 않는 결과’가 오는 경우 많음",
      variation:"安いのに高そうに見える。／行ったのに会えなかった。"
    },
    examples:[
      {jp:"頑張ったのに、うまくいきませんでした。", pron:"간밧타노니, 우마쿠 이키마센데시타", ko:"열심히 했는데도 잘 안 됐어요.", use:"✅ 상황: 결과가 반대", highlight:["のに"]},
      {jp:"行ったのに、会えませんでした。", pron:"잇타노니, 아에마센데시타", ko:"갔는데도 못 만났어요.", use:"✅ 상황: 허탕", highlight:["のに"]},
      {jp:"寒いのに、彼は半袖です。", pron:"사무이노니, 카레와 한소데데스", ko:"추운데도 그는 반팔이에요.", use:"✅ 상황: 예상 밖", highlight:["のに"]}
    ]
  },
  {
    cat:"contrast", tag:"대조/양보", title:"～けれども / ～けど (…하지만)",
    desc:"대조/전환(부드럽게 반대 내용으로 넘어감)",
    rule:"普通形 + <span class='hl'>けれども</span> (회화: けど)",
    warn:"문장 연결이 자연스러워져서 N3 독해에 자주 나옵니다.",
    extra:{
      core:"<span class='x-badge'>대조</span> “하지만”",
      situation:"말을 부드럽게 꺾거나, 반대 내용을 덧붙일 때",
      breakdown:"行きたい(싶다) + けど + 時間がない(시간없다)",
      caution:"문장 끝에 けど로 여운 남겨 공손하게 마무리 가능",
      variation:"行きたいけど…／好きだけど…"
    },
    examples:[
      {jp:"行きたいけれども、時間がありません。", pron:"이키타이케레도모, 지칸가 아리마센", ko:"가고 싶지만 시간이 없어요.", use:"✅ 상황: 부드러운 거절", highlight:["けれども"]},
      {jp:"この店は安いけど、人が多いです。", pron:"코노 미세와 야스이케도, 히토가 오오이데스", ko:"이 가게는 싸지만 사람이 많아요.", use:"✅ 상황: 장단점", highlight:["けど"]},
      {jp:"雨だけど、出かけます。", pron:"아메다케도, 데카케마스", ko:"비지만 나갈게요.", use:"✅ 상황: 반전 행동", highlight:["けど"]}
    ]
  },

  /* ✅ 추가(대조/양보) */
  {
    cat:"contrast", tag:"대조/양보", title:"～一方(で) (…하는 한편/반면)",
    desc:"A와 B를 비교하거나 동시에 말할 때(대조/병행)",
    rule:"普通形 + <span class='hl'>一方(で)</span>",
    warn:"독해에 자주. ‘장단점/현실’ 비교에 강함.",
    extra:{
      core:"<span class='x-badge'>대조</span> “한편/반면”",
      situation:"A 장점, B 단점처럼 비교 설명",
      breakdown:"便利だ + 一方で + 高い",
      caution:"문장 구조를 한 번에 읽는 연습이 중요",
      variation:"便利な一方(で)、高いです。"
    },
    examples:[
      {jp:"この町は便利な一方で、家賃が高いです。", pron:"코노 마치와 벤리나 잇포오데, 야친가 타카이데스", ko:"이 동네는 편리한 한편 집세가 비싸요.", use:"✅ 상황: 장단점", highlight:["一方で"]},
      {jp:"父は厳しい一方、やさしいところもあります。", pron:"치치와 키비시이 잇포오, 야사시이 토코로모 아리마스", ko:"아버지는 엄격한 한편 다정한 면도 있어요.", use:"✅ 상황: 성격 묘사", highlight:["一方"]},
      {jp:"都会は便利な一方、自然が少ないです。", pron:"토카이와 벤리나 잇포오, 시젠가 스쿠나이데스", ko:"도시는 편리한 반면 자연이 적어요.", use:"✅ 상황: 비교", highlight:["一方"]}
    ]
  },
  {
    cat:"contrast", tag:"대조/양보", title:"～わりに (…치고는)",
    desc:"기준(예상)에 비해 결과가 다름",
    rule:"普通形 + <span class='hl'>わりに</span> / 名詞 + のわりに",
    warn:"‘생각보다’ 느낌. 좋은/나쁜 둘 다 가능.",
    extra:{
      core:"<span class='x-badge'>비교</span> “~치고는”",
      situation:"가격/실력/시간 대비 평가",
      breakdown:"高い + わりに + おいしい",
      caution:"‘ほど’랑 달리 ‘예상과 다름’에 초점",
      variation:"値段のわりにおいしい。"
    },
    examples:[
      {jp:"この料理は高いわりに、おいしくないです。", pron:"코노 료오리와 타카이 와리니, 오이시쿠나이데스", ko:"이 요리는 비싼 치고는 맛없어요.", use:"✅ 상황: 기대 대비", highlight:["わりに"]},
      {jp:"彼は勉強したわりに、点が低いです。", pron:"카레와 벤쿄오시타 와리니, 텐가 히쿠이데스", ko:"그는 공부한 치고는 점수가 낮아요.", use:"✅ 상황: 노력 대비", highlight:["わりに"]},
      {jp:"この仕事は簡単なわりに、給料がいいです。", pron:"코노 시고토와 칸탄나 와리니, 큐우료오가 이이데스", ko:"이 일은 쉬운 치고는 월급이 좋아요.", use:"✅ 상황: 의외", highlight:["わりに"]}
    ]
  },

  /* =======================
     reason: 원인/결과
  ======================= */
  {
    cat:"reason", tag:"원인/결과", title:"～せいで (…때문에: 나쁜 결과)",
    desc:"원인 때문에 좋지 않은 결과가 생김(책임/불평)",
    rule:"普通形 + <span class='hl'>せいで</span>",
    warn:"대체로 ‘나쁜 결과’에 쓰는 게 자연스럽습니다.",
    extra:{
      core:"<span class='x-badge'>원인</span> “~때문에(부정적)”",
      situation:"불편/실패 원인을 말할 때",
      breakdown:"雨のせいで + 遅れた",
      caution:"좋은 이유는 ‘おかげで’와 대비",
      variation:"渋滞のせいで遅れました。"
    },
    examples:[
      {jp:"雨のせいで遅れました。", pron:"아메노 세에데 오쿠레마시타", ko:"비 때문에 늦었어요.", use:"✅ 상황: 변명/원인", highlight:["せいで"]},
      {jp:"渋滞のせいで間に合いませんでした。", pron:"주우타이노 세에데 마니아이마센데시타", ko:"정체 때문에 늦었어요.", use:"✅ 상황: 지각 사유", highlight:["せいで"]},
      {jp:"彼のせいで失敗しました。", pron:"카레노 세에데 싯파이시마시타", ko:"그 때문에 실패했어요.", use:"✅ 상황: 책임 강조", highlight:["せいで"]}
    ]
  },
  {
    cat:"reason", tag:"원인/결과", title:"～おかげで (…덕분에: 좋은 결과)",
    desc:"누군가/무언가 덕분에 좋은 결과가 생김",
    rule:"普通形 + <span class='hl'>おかげで</span>",
    warn:"감사/긍정 결과에 쓰는 대표 표현.",
    extra:{
      core:"<span class='x-badge'>긍정원인</span> “~덕분에”",
      situation:"도움/조건 덕분에 잘 됐을 때",
      breakdown:"先生のおかげで + 合格できた",
      caution:"아주 드물게 비꼼으로도 가능(문맥 주의)",
      variation:"友達のおかげで助かりました。"
    },
    examples:[
      {jp:"先生のおかげで合格できました。", pron:"센세에노 오카게데 고오카쿠 데키마시타", ko:"선생님 덕분에 합격했어요.", use:"✅ 상황: 감사", highlight:["おかげで"]},
      {jp:"友達のおかげで助かりました。", pron:"토모다치노 오카게데 타스카리마시타", ko:"친구 덕분에 도움이 됐어요.", use:"✅ 상황: 도움", highlight:["おかげで"]},
      {jp:"薬のおかげで元気になりました。", pron:"쿠스리노 오카게데 겡키니 나리마시타", ko:"약 덕분에 나아졌어요.", use:"✅ 상황: 회복", highlight:["おかげで"]}
    ]
  },
  {
    cat:"reason", tag:"원인/결과", title:"～ために (…하기 위해/…때문에)",
    desc:"목적(위해) 또는 원인(때문에)로 사용",
    rule:"동사辞書形 + <span class='hl'>ために</span> / 명사 + のために",
    warn:"N3는 ‘목적’이 더 자주. 문맥 따라 ‘때문에’도 가능.",
    extra:{
      core:"<span class='x-badge'>목적</span> “~하기 위해”",
      situation:"목표/목적을 말할 때",
      breakdown:"合格する + ために + 勉強する",
      caution:"원인 의미는 ‘事故のために’처럼 명사로 자주",
      variation:"健康のために運動します。"
    },
    examples:[
      {jp:"合格するために毎日勉強します。", pron:"고오카쿠스루 타메니 마이니치 벤쿄오시마스", ko:"합격하기 위해 매일 공부합니다.", use:"✅ 상황: 목표", highlight:["ために"]},
      {jp:"健康のために運動しています。", pron:"켕코오노 타메니 운도오시테이마스", ko:"건강을 위해 운동하고 있어요.", use:"✅ 상황: 목적", highlight:["ために"]},
      {jp:"大雨のために電車が止まりました。", pron:"오오아메노 타메니 덴샤가 토마리마시타", ko:"폭우 때문에 전철이 멈췄어요.", use:"✅ 상황: 원인(공식)", highlight:["ために"]}
    ]
  },

  /* ✅ 추가(원인/결과) */
  {
    cat:"reason", tag:"원인/결과", title:"～によって (…에 따라/…에 의해)",
    desc:"기준에 따라 결과가 달라짐 / 원인·수단(에 의해)",
    rule:"명사 + <span class='hl'>によって</span>",
    warn:"‘사람/상황에 따라 달라요’에서 매우 빈출.",
    extra:{
      core:"<span class='x-badge'>기준</span> “~에 따라”",
      situation:"방법/결과가 달라질 때",
      breakdown:"人によって + 考え方が違う",
      caution:"원인/수단: 地震によって壊れた",
      variation:"季節によって値段が変わります。"
    },
    examples:[
      {jp:"人によって考え方が違います。", pron:"히토니 욧테 칸가에카타가 치가이마스", ko:"사람에 따라 생각이 달라요.", use:"✅ 상황: 기준 차이", highlight:["によって"]},
      {jp:"季節によって値段が変わります。", pron:"키세츠니 욧테 네단가 카와리마스", ko:"계절에 따라 가격이 바뀌어요.", use:"✅ 상황: 변화 기준", highlight:["によって"]},
      {jp:"地震によって建物が壊れました。", pron:"지신니 욧테 타테모노가 코와레마시타", ko:"지진 때문에 건물이 무너졌어요.", use:"✅ 상황: 원인/영향", highlight:["によって"]}
    ]
  },

  /* =======================
     judgement: 판단/평가
  ======================= */
  {
    cat:"judgement", tag:"판단/평가", title:"～はずです (…할 리예요/…해야 해요)",
    desc:"강한 추측/당연한 결론(논리적)",
    rule:"普通形 + <span class='hl'>はずです</span>",
    warn:"‘당연히 그렇다’ 뉘앙스가 강합니다.",
    extra:{
      core:"<span class='x-badge'>논리추측</span> “~할 리다/해야 한다”",
      situation:"정보를 근거로 ‘당연히’ 결론 낼 때",
      breakdown:"もう出た + はずです",
      caution:"‘はずがない’(그럴 리 없다)도 함께 자주 등장",
      variation:"もうすぐ来るはずです。／そんなはずがない。"
    },
    examples:[
      {jp:"彼はもう家に着いたはずです。", pron:"카레와 모오 이에니 츠이타 하즈데스", ko:"그는 이미 집에 도착했을 거예요.", use:"✅ 상황: 논리 추측", highlight:["はずです"]},
      {jp:"今日は休みのはずです。", pron:"쿄오와 야스미노 하즈데스", ko:"오늘은 쉬는 날일 거예요.", use:"✅ 상황: 일정 확신", highlight:["はずです"]},
      {jp:"そんなはずがありません。", pron:"손나 하즈가 아리마센", ko:"그럴 리가 없어요.", use:"✅ 상황: 강한 부정", highlight:["はずが"]}
    ]
  },
  {
    cat:"judgement", tag:"판단/평가", title:"～かもしれません (…일지도 몰라요)",
    desc:"불확실한 추측(가능성)",
    rule:"普通形 + <span class='hl'>かもしれません</span>",
    warn:"확신이 없을 때 가장 무난한 표현.",
    extra:{
      core:"<span class='x-badge'>가능성</span> “~일지도”",
      situation:"정확히 모르지만 가능성 언급",
      breakdown:"遅れる + かもしれません",
      caution:"확신 낮음 → 안전한 표현(회사/일상 모두 OK)",
      variation:"雨かもしれません。／来ないかもしれません。"
    },
    examples:[
      {jp:"電車が遅れるかもしれません。", pron:"덴샤가 오쿠레루 카모시레마센", ko:"전철이 늦을지도 몰라요.", use:"✅ 상황: 불확실 안내", highlight:["かもしれません"]},
      {jp:"明日は雨かもしれません。", pron:"아시타와 아메 카모시레마센", ko:"내일 비가 올지도 몰라요.", use:"✅ 상황: 날씨 가능성", highlight:["かもしれません"]},
      {jp:"彼は来ないかもしれません。", pron:"카레와 코나이 카모시레마센", ko:"그는 안 올지도 몰라요.", use:"✅ 상황: 참석 불확실", highlight:["かもしれません"]}
    ]
  },
  {
    cat:"judgement", tag:"판단/평가", title:"～ようです (…인 것 같다: 관찰/추정)",
    desc:"상황·근거로 판단(보니 그런 듯)",
    rule:"普通形 + <span class='hl'>ようです</span>",
    warn:"‘そうです(모양)’보다 조금 더 ‘근거 있는 추정’ 느낌.",
    extra:{
      core:"<span class='x-badge'>추정</span> “~인 것 같다”",
      situation:"증거/상황을 보고 조심스럽게 판단",
      breakdown:"誰もいない + ようです",
      caution:"회화: ようだ/みたい(비슷한 느낌)",
      variation:"雨が降るようです。／もう終わったようです。"
    },
    examples:[
      {jp:"外は雨が降っているようです。", pron:"소토와 아메가 훗테이루 요오데스", ko:"밖은 비가 오는 것 같아요.", use:"✅ 상황: 관찰 기반", highlight:["ようです"]},
      {jp:"彼はまだ寝ているようです。", pron:"카레와 마다 네테이루 요오데스", ko:"그는 아직 자고 있는 것 같아요.", use:"✅ 상황: 상황 판단", highlight:["ようです"]},
      {jp:"もう終わったようです。", pron:"모오 오왓타 요오데스", ko:"이미 끝난 것 같아요.", use:"✅ 상황: 결과 추정", highlight:["ようです"]}
    ]
  },

  /* ✅ 추가(판단/평가) */
  {
    cat:"judgement", tag:"판단/평가", title:"～わけではありません (…인 것은 아니다)",
    desc:"부분 부정(전부/항상 그런 건 아님)",
    rule:"普通形 + <span class='hl'>わけではありません</span>",
    warn:"N3 독해/문법 단골. ‘전체 부정’이 아니라 ‘부분 부정’.",
    extra:{
      core:"<span class='x-badge'>부분부정</span> “~인 것은 아니다”",
      situation:"오해를 풀거나, ‘항상/전부’가 아님을 말할 때",
      breakdown:"嫌いだ + わけではありません(완전 싫은 건 아님)",
      caution:"‘わけがない’(그럴 리 없다)와 혼동 주의",
      variation:"高いわけではありません。／いつも行くわけではありません。"
    },
    examples:[
      {jp:"日本語が嫌いなわけではありません。", pron:"니혼고가 키라이나 와케데와 아리마센", ko:"일본어가 싫은 건 아니에요.", use:"✅ 상황: 오해 해명", highlight:["わけではありません"]},
      {jp:"毎日運動するわけではありません。", pron:"마이니치 운도오스루 와케데와 아리마센", ko:"매일 운동하는 건 아니에요.", use:"✅ 상황: 빈도 제한", highlight:["わけではありません"]},
      {jp:"全部が正しいわけではありません。", pron:"젠부가 타다시이 와케데와 아리마센", ko:"전부가 맞는 건 아니에요.", use:"✅ 상황: 부분 인정", highlight:["わけではありません"]}
    ]
  },
  {
    cat:"judgement", tag:"판단/평가", title:"～わけがありません / ～わけがない (그럴 리 없다)",
    desc:"강한 부정 추측(절대 그럴 리 없다)",
    rule:"普通形 + <span class='hl'>わけがありません</span>",
    warn:"근거를 두고 ‘절대 아니다’라고 강하게 말함.",
    extra:{
      core:"<span class='x-badge'>강한부정</span> “~할 리 없다”",
      situation:"상대 말에 강한 부정/반박",
      breakdown:"そんな + わけがない",
      caution:"‘はずがない’와 비슷(둘 다 N3급으로 자주)",
      variation:"彼がうそをつくわけがない。"
    },
    examples:[
      {jp:"そんなわけがありません。", pron:"손나 와케가 아리마센", ko:"그럴 리가 없어요.", use:"✅ 상황: 강한 부정", highlight:["わけがありません"]},
      {jp:"彼が来ないわけがないです。", pron:"카레가 코나이 와케가 나이데스", ko:"그가 안 올 리가 없어요.", use:"✅ 상황: 반박/확신", highlight:["わけがない"]},
      {jp:"この問題が簡単なわけがありません。", pron:"코노 몬다이가 칸탄나 와케가 아리마센", ko:"이 문제가 쉬울 리가 없어요.", use:"✅ 상황: 난이도 판단", highlight:["わけがありません"]}
    ]
  },

  /* =======================
     intention: 의지/계획
  ======================= */
  {
    cat:"intention", tag:"의지/계획", title:"～ようにします (…하도록 노력하다)",
    desc:"의식적으로 습관/노력을 하다",
    rule:"동사辞書形 + <span class='hl'>ようにします</span>",
    warn:"N3에서 ‘노력/의식’ 뉘앙스 중요.",
    extra:{
      core:"<span class='x-badge'>노력</span> “~하도록 한다(습관화)”",
      situation:"건강/공부/생활습관 개선",
      breakdown:"早く寝る + ようにします",
      caution:"‘ようになります’(자연 변화)와 구분: 여긴 ‘의지적’",
      variation:"毎日歩くようにします。／忘れないようにします。"
    },
    examples:[
      {jp:"早く寝るようにします。", pron:"하야쿠 네루 요오니 시마스", ko:"일찍 자도록 할게요.", use:"✅ 상황: 습관", highlight:["ようにします"]},
      {jp:"忘れないようにメモします。", pron:"와스레나이 요오니 메모시마스", ko:"잊지 않도록 메모해요.", use:"✅ 상황: 예방", highlight:["ように"]},
      {jp:"毎日運動するようにしています。", pron:"마이니치 운도오스루 요오니 시테이마스", ko:"매일 운동하려고 하고 있어요.", use:"✅ 상황: 지속", highlight:["ようにしています"]}
    ]
  },

  /* ✅ 추가(의지/계획) */
  {
    cat:"intention", tag:"의지/계획", title:"～つもりでした (…할 생각이었어요)",
    desc:"원래 계획/의도가 있었지만(실현 여부는 문맥)",
    rule:"동사辞書形/ない形 + <span class='hl'>つもりでした</span>",
    warn:"‘원래는’ 뉘앙스로 과거 계획을 말함.",
    extra:{
      core:"<span class='x-badge'>과거계획</span> “~하려고 했어요”",
      situation:"계획 변경/아쉬움 말할 때",
      breakdown:"行く + つもりでした",
      caution:"실제로 안 했으면 뒤에 이유가 자주 붙음",
      variation:"買うつもりでしたが、やめました。"
    },
    examples:[
      {jp:"昨日、映画を見るつもりでした。", pron:"키노오, 에이가오 미루 츠모리데시타", ko:"어제 영화 볼 생각이었어요.", use:"✅ 상황: 계획 회상", highlight:["つもりでした"]},
      {jp:"日本へ行くつもりでしたが、行けませんでした。", pron:"니혼에 이쿠 츠모리데시타가, 이케마센데시타", ko:"일본에 갈 생각이었는데 못 갔어요.", use:"✅ 상황: 계획 변경", highlight:["つもりでした"]},
      {jp:"この本を買うつもりでした。", pron:"코노 혼오 카우 츠모리데시타", ko:"이 책을 살 생각이었어요.", use:"✅ 상황: 구매 의도", highlight:["つもりでした"]}
    ]
  },
  {
    cat:"intention", tag:"의지/계획", title:"～ことにします / ～ことになります (…하기로 하다/…하게 되다)",
    desc:"스스로 결정(ことにします) / 상황에 의해 결정(ことになります)",
    rule:"동사辞書形/ない形 + <span class='hl'>ことにします</span> / <span class='hl'>ことになります</span>",
    warn:"둘의 주체 차이를 잡는 게 포인트.",
    extra:{
      core:"<span class='x-badge'>결정</span> “~하기로 하다/되다”",
      situation:"규칙·방침·결정 전달",
      breakdown:"禁煙にする→禁煙することになります",
      caution:"ことになります는 ‘나 말고’ 결정됨(회사/학교 공지 느낌)",
      variation:"毎日勉強することにします。／来月から値上げすることになります。"
    },
    examples:[
      {jp:"今日から毎日勉強することにします。", pron:"쿄오카라 마이니치 벤쿄오스루 코토니 시마스", ko:"오늘부터 매일 공부하기로 했어요.", use:"✅ 상황: 내 결심", highlight:["ことにします"]},
      {jp:"会社のルールで、残業しないことになりました。", pron:"카이샤노 루우루데, 잔교오시나이 코토니 나리마시타", ko:"회사 규정으로 잔업을 안 하게 됐어요.", use:"✅ 상황: 규정 결정", highlight:["ことになりました"]},
      {jp:"会議は来週にすることになりました。", pron:"카이기와 라이슈우니 스루 코토니 나리마시타", ko:"회의는 다음 주에 하게 됐어요.", use:"✅ 상황: 일정 결정", highlight:["ことになりました"]}
    ]
  },
  {
    cat:"intention", tag:"의지/계획", title:"～ようと思います / ～ようと思っています (…하려고 해요/생각 중)",
    desc:"의향/의도(생각/계획)",
    rule:"동사意向形(よう/おう) + <span class='hl'>と思います</span>",
    warn:"‘つもり’보다 가볍거나 ‘생각 중’ 느낌이 나기 쉬움.",
    extra:{
      core:"<span class='x-badge'>의향</span> “~하려고 한다”",
      situation:"가벼운 계획/의지 표현",
      breakdown:"始めよう + と思います",
      caution:"계속 생각 중은 と思っています",
      variation:"早く帰ろうと思います。／勉強しようと思っています。"
    },
    examples:[
      {jp:"週末は家で休もうと思います。", pron:"슈우마츠와 이에데 야스모오 토 오모이마스", ko:"주말엔 집에서 쉬려고 해요.", use:"✅ 상황: 주말 계획", highlight:["ようと思います"]},
      {jp:"来年、留学しようと思っています。", pron:"라이넨, 류우가쿠시요오 토 오모옷테이마스", ko:"내년에 유학하려고 생각 중이에요.", use:"✅ 상황: 장기 계획", highlight:["ようと思っています"]},
      {jp:"今日は早く寝ようと思います。", pron:"쿄오와 하야쿠 네요오 토 오모이마스", ko:"오늘은 일찍 자려고 해요.", use:"✅ 상황: 당일 결심", highlight:["ようと思います"]}
    ]
  },

  /* =======================
     guess: 추측/전언
  ======================= */
  {
    cat:"guess", tag:"추측/전언", title:"～らしい (…인 모양이다/…라고 하더라)",
    desc:"전언+추측(들었거나 분위기로 그렇게 보임)",
    rule:"普通形 + <span class='hl'>らしい</span>",
    warn:"N3는 ‘전언/추측의 중간’ 느낌을 잡는 게 핵심.",
    extra:{
      core:"<span class='x-badge'>전언+추측</span> “~인 모양/~라더라”",
      situation:"확정은 아니지만 ‘그렇다더라/그런 듯’",
      breakdown:"彼は忙しい + らしい",
      caution:"전언(そうだ)보다 더 ‘추측’이 섞임",
      variation:"雨らしいです。／彼は来ないらしい。"
    },
    examples:[
      {jp:"明日は雨らしいです。", pron:"아시타와 아메라시이데스", ko:"내일은 비가 온대요/올 것 같아요.", use:"✅ 상황: 들은 정보", highlight:["らしい"]},
      {jp:"彼は今、忙しいらしいです。", pron:"카레와 이마, 이소가시이라시이데스", ko:"그는 지금 바쁜 모양이에요.", use:"✅ 상황: 소문/분위기", highlight:["らしい"]},
      {jp:"この店は人気があるらしいです。", pron:"코노 미세와 닌키가 아루라시이데스", ko:"이 가게는 인기 있는 것 같아요.", use:"✅ 상황: 평판", highlight:["らしい"]}
    ]
  },

  /* ✅ 추가(추측/전언) */
  {
    cat:"guess", tag:"추측/전언", title:"～みたいです (…같아요/…인 모양이에요)",
    desc:"관찰/느낌 기반 추측(회화에서 매우 자주)",
    rule:"普通形 + <span class='hl'>みたいです</span>",
    warn:"‘ようです’보다 회화 느낌. 독해에도 종종 등장.",
    extra:{
      core:"<span class='x-badge'>추측</span> “~같다”",
      situation:"겉모습/상황 보고 판단",
      breakdown:"雨が降る + みたいです",
      caution:"명사/な형용사도 붙음: 学生みたい",
      variation:"彼は寝ているみたいです。"
    },
    examples:[
      {jp:"外は寒いみたいです。", pron:"소토와 사무이 미타이데스", ko:"밖은 추운 것 같아요.", use:"✅ 상황: 느낌/추정", highlight:["みたいです"]},
      {jp:"彼はもう帰ったみたいです。", pron:"카레와 모오 카엣타 미타이데스", ko:"그는 이미 돌아간 것 같아요.", use:"✅ 상황: 상황 추정", highlight:["みたいです"]},
      {jp:"このケーキ、おいしいみたいです。", pron:"코노 케에키, 오이시이 미타이데스", ko:"이 케이크 맛있는 것 같아요.", use:"✅ 상황: 반응/평", highlight:["みたいです"]}
    ]
  },

  /* =======================
     limit: 한정/강조
  ======================= */
  {
    cat:"limit", tag:"한정/강조", title:"～ばかり (방금/거의/만)",
    desc:"(1) 방금 했다 (2) ~만 한다 (3) 거의 ~뿐",
    rule:"동사た形 + <span class='hl'>ばかり</span> / 명사 + ばかり",
    warn:"의미가 여러 개라 ‘문맥’이 포인트.",
    extra:{
      core:"<span class='x-badge'>한정/직후</span> “~만 / 방금”",
      situation:"‘방금’은 たばかり / ‘~만’은 Nばかり",
      breakdown:"食べた + ばかり",
      caution:"‘だけ’와 비슷하지만 ‘ばかり’는 ‘거의’ 뉘앙스 가능",
      variation:"来たばかりです。／文句ばかり言う。"
    },
    examples:[
      {jp:"さっき食べたばかりです。", pron:"삿키 타베타 바카리데스", ko:"아까 막 먹었어요.", use:"✅ 상황: 직후 강조", highlight:["たばかり"]},
      {jp:"彼は文句ばかり言います。", pron:"카레와 몽쿠 바카리 이이마스", ko:"그는 불평만 해요.", use:"✅ 상황: ‘~만’ 반복", highlight:["ばかり"]},
      {jp:"最近、忙しいことばかりです。", pron:"사이킨, 이소가시이 코토 바카리데스", ko:"요즘 바쁜 일뿐이에요.", use:"✅ 상황: 거의 ~뿐", highlight:["ばかり"]}
    ]
  },

  /* ✅ 추가(한정/강조) */
  {
    cat:"limit", tag:"한정/강조", title:"～しか～ない (…밖에 없다)",
    desc:"선택/수량/방법이 제한됨",
    rule:"명사 + <span class='hl'>しか</span> + 부정(ない)",
    warn:"반드시 부정과 세트(ない).",
    extra:{
      core:"<span class='x-badge'>제한</span> “~밖에 없다”",
      situation:"선택지가 적을 때",
      breakdown:"千円しか + ありません",
      caution:"‘だけ’보다 ‘부족/제한’ 느낌이 강함",
      variation:"今はこれしかありません。"
    },
    examples:[
      {jp:"千円しかありません。", pron:"센엔시카 아리마센", ko:"천 엔밖에 없어요.", use:"✅ 상황: 돈 부족", highlight:["しか"]},
      {jp:"日曜日しか休みがありません。", pron:"니치요오비시카 야스미가 아리마센", ko:"일요일만 쉴 수 있어요.", use:"✅ 상황: 휴일 제한", highlight:["しか"]},
      {jp:"ここで待つしかないです。", pron:"코코데 마츠시카 나이데스", ko:"여기서 기다릴 수밖에 없어요.", use:"✅ 상황: 방법 제한", highlight:["しかない"]}
    ]
  },
  {
    cat:"limit", tag:"한정/강조", title:"～だけでなく～も (…뿐만 아니라 …도)",
    desc:"추가/확장(둘 다 포함)",
    rule:"명사/普通形 + <span class='hl'>だけでなく</span> + 명사/문 + <span class='hl'>も</span>",
    warn:"N3 독해에서 ‘범위 확장’ 표현으로 자주.",
    extra:{
      core:"<span class='x-badge'>추가</span> “~뿐만 아니라 ~도”",
      situation:"특징/대상을 추가로 말할 때",
      breakdown:"日本語だけでなく + 英語も",
      caution:"비슷: ～ばかりでなく～も(문어 느낌)",
      variation:"勉強だけでなく運動もします。"
    },
    examples:[
      {jp:"彼は日本語だけでなく、英語も話せます。", pron:"카레와 니혼고다케데나쿠, 에이고모 하나세마스", ko:"그는 일본어뿐만 아니라 영어도 할 수 있어요.", use:"✅ 상황: 능력 추가", highlight:["だけでなく","も"]},
      {jp:"この店は安いだけでなく、早いです。", pron:"코노 미세와 야스이다케데나쿠, 하야이데스", ko:"이 가게는 싼 것뿐만 아니라 빨라요.", use:"✅ 상황: 장점 확장", highlight:["だけでなく"]},
      {jp:"子どもだけでなく、大人も楽しめます。", pron:"코도모다케데나쿠, 오토나모 타노시메마스", ko:"아이뿐만 아니라 어른도 즐길 수 있어요.", use:"✅ 상황: 대상 확장", highlight:["だけでなく","も"]}
    ]
  },
  {
    cat:"limit", tag:"한정/강조", title:"～ほど (…정도/…만큼)",
    desc:"정도/비교(강도·범위)",
    rule:"普通形 + <span class='hl'>ほど</span>",
    warn:"비교/강조에 매우 자주. 독해 체감 빈출.",
    extra:{
      core:"<span class='x-badge'>정도</span> “~정도”",
      situation:"강도/정도를 말할 때",
      breakdown:"死ぬほど + 忙しい(죽을 만큼 바쁘다)",
      caution:"부정 비교: ～ほど～ない(추가 항목 참고)",
      variation:"思ったほど難しくない。"
    },
    examples:[
      {jp:"思ったほど難しくありません。", pron:"오못타호도 무즈카시쿠 아리마센", ko:"생각했던 만큼 어렵지 않아요.", use:"✅ 상황: 기대 대비", highlight:["ほど"]},
      {jp:"歩けないほど疲れました。", pron:"아루케나이호도 츠카레마시타", ko:"걸을 수 없을 정도로 피곤했어요.", use:"✅ 상황: 강한 정도", highlight:["ほど"]},
      {jp:"毎日、日本語を話すほど勉強しています。", pron:"마이니치, 니혼고오 하나스호도 벤쿄오시테이마스", ko:"매일 일본어를 말할 정도로 공부하고 있어요.", use:"✅ 상황: 정도 강조", highlight:["ほど"]}
    ]
  },
  {
    cat:"limit", tag:"한정/강조", title:"～ほど～ない (…만큼 ~하지 않다)",
    desc:"비교 부정(상대가 더 강함)",
    rule:"AはBほど + 부정",
    warn:"‘B만큼은 아니다’로 자주 출제됨.",
    extra:{
      core:"<span class='x-badge'>비교부정</span> “~만큼 ~하지 않다”",
      situation:"겸손/현실 비교",
      breakdown:"私は彼ほど + 上手ではない",
      caution:"‘より’(더)와 같이 비교 문장 읽기",
      variation:"今年は去年ほど寒くない。"
    },
    examples:[
      {jp:"私は彼ほど上手ではありません。", pron:"와타시와 카레호도 조오즈데와 아리마센", ko:"저는 그만큼 잘하지는 않아요.", use:"✅ 상황: 겸손 비교", highlight:["ほど"]},
      {jp:"今年は去年ほど寒くないです。", pron:"코토시와 쿄넨호도 사무쿠나이데스", ko:"올해는 작년만큼 춥지 않아요.", use:"✅ 상황: 날씨 비교", highlight:["ほど"]},
      {jp:"この店は思ったほど高くないです。", pron:"코노 미세와 오못타호도 타카쿠나이데스", ko:"이 가게는 생각만큼 비싸지 않아요.", use:"✅ 상황: 가격 비교", highlight:["ほど"]}
    ]
  },

  /* =======================
     tendency: 습관/경향
  ======================= */
  {
    cat:"tendency", tag:"습관/경향", title:"～がち (…하기 쉽다/…하는 경향)",
    desc:"부정적 경향이 많음(자주 그러다)",
    rule:"명사/동사ます형 어간 + <span class='hl'>がち</span>",
    warn:"대체로 안 좋은 경향에 자주 씁니다.",
    extra:{
      core:"<span class='x-badge'>경향</span> “~하기 쉽다”",
      situation:"자주 그런 일이 생길 때(부정적)",
      breakdown:"遅れ(ます어간) + がち",
      caution:"‘やすい’(하기 쉽다)와 비슷하지만 ‘경향’ 느낌 강함",
      variation:"遅れがちです。／忘れがちです。"
    },
    examples:[
      {jp:"雨の日は遅れがちです。", pron:"아메노 히와 오쿠레가치데스", ko:"비 오는 날은 늦기 쉬워요.", use:"✅ 상황: 경향", highlight:["がち"]},
      {jp:"最近、忘れがちです。", pron:"사이킨, 와스레가치데스", ko:"요즘 자꾸 잊어버려요.", use:"✅ 상황: 반복", highlight:["がち"]},
      {jp:"彼は病気がちです。", pron:"카레와 뵤오키가치데스", ko:"그는 병치레가 잦아요.", use:"✅ 상황: 상태", highlight:["がち"]}
    ]
  },

  /* ✅ 추가(습관/경향) */
  {
    cat:"tendency", tag:"습관/경향", title:"～っぽい (…같다/…경향이 있다)",
    desc:"(1) ~같다(느낌) (2) ~하기 쉽다(성향)",
    rule:"명사 + <span class='hl'>っぽい</span> / 동사ます형 어간 + っぽい",
    warn:"회화에서 매우 자주. ‘경향’ 의미도 N3급.",
    extra:{
      core:"<span class='x-badge'>느낌/성향</span> “~같다/~하기 쉽다”",
      situation:"성격·상태·행동 성향",
      breakdown:"忘れっぽい(잘 잊는)",
      caution:"너무 구어라서 독해보단 회화/청해 쪽 체감 큼",
      variation:"子どもっぽい。／飽きっぽい。"
    },
    examples:[
      {jp:"彼は忘れっぽいです。", pron:"카레와 와스레뽀이데스", ko:"그는 잘 잊어버려요.", use:"✅ 상황: 성향", highlight:["っぽい"]},
      {jp:"この服は安っぽいです。", pron:"코노 후쿠와 야스뽀이데스", ko:"이 옷은 싸 보입니다.", use:"✅ 상황: 인상", highlight:["っぽい"]},
      {jp:"彼女は子どもっぽいところがあります。", pron:"카노죠와 코도모뽀이 토코로가 아리마스", ko:"그녀는 어린애 같은 면이 있어요.", use:"✅ 상황: 성격 묘사", highlight:["っぽい"]}
    ]
  },
  {
    cat:"tendency", tag:"습관/경향", title:"～やすい / ～にくい (…하기 쉽다/…하기 어렵다)",
    desc:"행동의 난이도/특성",
    rule:"동사ます형 어간 + <span class='hl'>やすい</span> / <span class='hl'>にくい</span>",
    warn:"‘물리적/심리적’ 둘 다 가능. N3 단골.",
    extra:{
      core:"<span class='x-badge'>난이도</span> “~하기 쉽다/어렵다”",
      situation:"사용성/습관/느낌 표현",
      breakdown:"読み(어간) + やすい",
      caution:"‘がち’는 경향, ‘にくい’는 ‘어렵다’(난이도) 느낌",
      variation:"このペンは書きやすい。／この字は読みにくい。"
    },
    examples:[
      {jp:"このペンは書きやすいです。", pron:"코노 펜와 카키야스이데스", ko:"이 펜은 쓰기 쉬워요.", use:"✅ 상황: 사용성", highlight:["やすい"]},
      {jp:"この漢字は読みにくいです。", pron:"코노 칸지와 요미니쿠이데스", ko:"이 한자는 읽기 어려워요.", use:"✅ 상황: 난이도", highlight:["にくい"]},
      {jp:"彼は話しかけにくいです。", pron:"카레와 하나시카케니쿠이데스", ko:"그는 말 걸기 어려워요.", use:"✅ 상황: 심리적 어려움", highlight:["にくい"]}
    ]
  },

  /* =======================
     connect: 연결/진행
  ======================= */
  {
    cat:"connect", tag:"연결/진행", title:"～一方で (…하는 한편)",
    desc:"두 가지를 대조/병행해서 말할 때",
    rule:"普通形 + <span class='hl'>一方で</span>",
    warn:"독해에서 대조 구조로 자주 등장합니다.",
    extra:{
      core:"<span class='x-badge'>대조/병행</span> “한편”",
      situation:"A와 B를 비교하거나 동시에 말할 때",
      breakdown:"便利だ + 一方で + 高い",
      caution:"문장 구조를 한 번에 잡는 게 포인트",
      variation:"便利な一方で高いです。"
    },
    examples:[
      {jp:"この町は便利な一方で、家賃が高いです。", pron:"코노 마치와 벤리나 잇포오데, 야친가 타카이데스", ko:"이 동네는 편리한 한편 집세가 비싸요.", use:"✅ 상황: 장단점 비교", highlight:["一方で"]},
      {jp:"彼は優しい一方で、厳しいところもあります。", pron:"카레와 야사시이 잇포오데, 키비시이 토코로모 아리마스", ko:"그는 다정한 한편 엄격한 면도 있어요.", use:"✅ 상황: 성격", highlight:["一方で"]},
      {jp:"仕事が忙しい一方で、やりがいもあります。", pron:"시고토가 이소가시이 잇포오데, 야리가이모 아리마스", ko:"일이 바쁜 한편 보람도 있어요.", use:"✅ 상황: 현실", highlight:["一方で"]}
    ]
  },

  /* ✅ 추가(연결/진행) */
  {
    cat:"connect", tag:"연결/진행", title:"～ていきます / ～てきます (…해 가다/…해 오다)",
    desc:"시간 흐름에 따른 변화/추이(앞으로/지금까지)",
    rule:"동사 て형 + <span class='hl'>いきます</span> / <span class='hl'>きます</span>",
    warn:"N3 핵심. ‘변화 방향’이 포인트.",
    extra:{
      core:"<span class='x-badge'>추이</span> “~해가다/해오다”",
      situation:"앞으로 변할 것/지금까지 변해온 것",
      breakdown:"増えて(변화) + いきます(앞으로)",
      caution:"いく=앞으로 / くる=지금까지 or 다가옴",
      variation:"暑くなっていきます。／上手になってきました。"
    },
    examples:[
      {jp:"これから暑くなっていきます。", pron:"코레카라 아츠쿠 낫테이키마스", ko:"앞으로 더워져 갈 거예요.", use:"✅ 상황: 앞으로 변화", highlight:["ていきます"]},
      {jp:"日本語がだんだん上手になってきました。", pron:"니혼고가 단단 조오즈니 낫테키마시타", ko:"일본어가 점점 늘어왔어요.", use:"✅ 상황: 지금까지 변화", highlight:["てきました"]},
      {jp:"雨が降ってきました。", pron:"아메가 훗테키마시타", ko:"비가 오기 시작했어요(다가옴).", use:"✅ 상황: 현상 변화", highlight:["てきました"]}
    ]
  },
  {
    cat:"connect", tag:"연결/진행", title:"～という (…라고 하는/…라는)",
    desc:"명사 수식/정의/내용 소개",
    rule:"普通形 + <span class='hl'>という</span> + 명사",
    warn:"독해에서 ‘정의/설명’으로 빈출.",
    extra:{
      core:"<span class='x-badge'>정의</span> “~라는”",
      situation:"이름/내용을 설명할 때",
      breakdown:"AというB = ‘A라는 B’",
      caution:"‘ということ’(내용/사실)도 함께 자주",
      variation:"“さくら”という店／日本で有名という話"
    },
    examples:[
      {jp:"これは“さくら”という店です。", pron:"코레와 사쿠라 토 이우 미세데스", ko:"이곳은 ‘사쿠라’라는 가게예요.", use:"✅ 상황: 이름 소개", highlight:["という"]},
      {jp:"田中さんという人を知っていますか。", pron:"타나카상 토 이우 히토오 싯테이마스카", ko:"다나카라는 사람 알아요?", use:"✅ 상황: 인물 소개", highlight:["という"]},
      {jp:"日本には温泉という文化があります。", pron:"니혼니와 온센 토 이우 분카가 아리마스", ko:"일본에는 온천이라는 문화가 있어요.", use:"✅ 상황: 정의/설명", highlight:["という"]}
    ]
  },

  /* =======================
     advice: 충고/요구
  ======================= */
  {
    cat:"advice", tag:"충고/요구", title:"～たほうがいい (…하는 게 좋아요)",
    desc:"충고/권유(상대에게)",
    rule:"동사た形 + <span class='hl'>ほうがいい</span>",
    warn:"시험/회화 둘 다 빈출. 부정형도 자주 나옵니다.",
    extra:{
      core:"<span class='x-badge'>충고</span> “~하는 게 좋아요”",
      situation:"조언/권유(건강, 공부, 선택)",
      breakdown:"早く寝た + ほうがいい",
      caution:"부정: 行かないほうがいい",
      variation:"病院へ行ったほうがいいです。／無理しないほうがいい。"
    },
    examples:[
      {jp:"早く寝たほうがいいです。", pron:"하야쿠 네타 호오가 이이데스", ko:"일찍 자는 게 좋아요.", use:"✅ 상황: 건강 조언", highlight:["たほうがいい"]},
      {jp:"病院へ行ったほうがいいです。", pron:"뵤오인에 잇타 호오가 이이데스", ko:"병원에 가는 게 좋아요.", use:"✅ 상황: 상태", highlight:["たほうがいい"]},
      {jp:"無理しないほうがいいです。", pron:"무리시나이 호오가 이이데스", ko:"무리하지 않는 게 좋아요.", use:"✅ 상황: 말리기", highlight:["ないほうがいい"]}
    ]
  },

  /* ✅ 추가(충고/요구) */
  {
    cat:"advice", tag:"충고/요구", title:"～ように言います (…하라고 말하다)",
    desc:"간접명령/전달(누구에게 ~하도록 말하다)",
    rule:"동사辞書形/ない形 + <span class='hl'>ように</span> + 言います",
    warn:"직접 명령(命令形)보다 부드럽고 공손한 전달.",
    extra:{
      core:"<span class='x-badge'>전달</span> “~하라고 하다”",
      situation:"부탁/지시를 전달할 때",
      breakdown:"早く来る + ように + 言う",
      caution:"‘ようにする’(노력)와 구분: 여긴 ‘말하다’",
      variation:"先生は静かにするように言いました。"
    },
    examples:[
      {jp:"母に早く帰るように言われました。", pron:"하하니 하야쿠 카에루 요오니 이와레마시타", ko:"엄마에게 일찍 돌아오라고 들었어요.", use:"✅ 상황: 지시 전달", highlight:["ように"]},
      {jp:"先生は宿題を忘れないように言いました。", pron:"센세에와 슈쿠다이오 와스레나이 요오니 이이마시타", ko:"선생님이 숙제 잊지 말라고 했어요.", use:"✅ 상황: 주의", highlight:["ように"]},
      {jp:"彼に無理しないように言ってください。", pron:"카레니 무리시나이 요오니 잇테 쿠다사이", ko:"그에게 무리하지 말라고 말해 주세요.", use:"✅ 상황: 부탁 전달", highlight:["ように"]}
    ]
  },

  /* =======================
     time: 시간/순서
  ======================= */
  /* ✅ 추가(시간/순서) */
  {
    cat:"time", tag:"시간/순서", title:"～ところです (막 ~하는 중/막 ~하려는 참/막 ~한 참)",
    desc:"바로 직전/진행 중/직후를 정확히 말함",
    rule:"辞書形 + ところ(직전) / ているところ(진행) / たところ(직후)",
    warn:"세 가지(직전/진행/직후) 구분이 출제 포인트.",
    extra:{
      core:"<span class='x-badge'>시간정확</span> “막 ~하려던/하는 중/한 참”",
      situation:"타이밍 설명(지금 딱)",
      breakdown:"今、食べているところです",
      caution:"‘たばかり’(방금)와 유사하지만 ‘ところ’가 더 ‘지금 이 순간’ 느낌",
      variation:"出かけるところです。／調べているところです。／今終わったところです。"
    },
    examples:[
      {jp:"今から出かけるところです。", pron:"이마카라 데카케루 토코로데스", ko:"지금 막 나가려는 참이에요.", use:"✅ 상황: 직전", highlight:["ところです"]},
      {jp:"ちょうど勉強しているところです。", pron:"초오도 벤쿄오시테이루 토코로데스", ko:"마침 공부하고 있는 중이에요.", use:"✅ 상황: 진행 중", highlight:["ているところ"]},
      {jp:"今、帰ったところです。", pron:"이마, 카엣타 토코로데스", ko:"지금 막 돌아온 참이에요.", use:"✅ 상황: 직후", highlight:["たところ"]}
    ]
  },
  {
    cat:"time", tag:"시간/순서", title:"～最中に (…하는 중에)",
    desc:"어떤 행동이 한창 진행 중일 때(중간에 사건)",
    rule:"동사ている + <span class='hl'>最中に</span> / 名詞の最中に",
    warn:"‘한창 ~중에’라서 중간 끼어드는 사건이 잘 옴.",
    extra:{
      core:"<span class='x-badge'>한창</span> “~하는 중에”",
      situation:"전화/사고/방문 등 ‘중간에’ 발생",
      breakdown:"会議をしている最中に + 電話が鳴った",
      caution:"‘間に’와 비슷하지만 ‘最中’는 ‘한창’ 강조",
      variation:"食事の最中に…／仕事の最中に…"
    },
    examples:[
      {jp:"会議の最中に電話が鳴りました。", pron:"카이기노 사이추우니 덴와가 나리마시타", ko:"회의 중에 전화가 울렸어요.", use:"✅ 상황: 진행 중 사건", highlight:["最中に"]},
      {jp:"勉強している最中に、友達が来ました。", pron:"벤쿄오시테이루 사이추우니, 토모다치가 키마시타", ko:"공부하는 중에 친구가 왔어요.", use:"✅ 상황: 방문", highlight:["最中に"]},
      {jp:"食事の最中に話しかけないでください。", pron:"쇼쿠지노 사이추우니 하나시카케나이데 쿠다사이", ko:"식사 중에는 말 걸지 말아 주세요.", use:"✅ 상황: 매너/규칙", highlight:["最中に"]}
    ]
  },
  {
    cat:"time", tag:"시간/순서", title:"～うちに (…하는 동안에/…하기 전에)",
    desc:"어떤 상태가 바뀌기 전에(좋은 타이밍 놓치지 않기)",
    rule:"동사辞書形/ない形 + <span class='hl'>うちに</span> / い形・な形 + うちに",
    warn:"‘상태가 바뀌기 전’ 느낌이 강함.",
    extra:{
      core:"<span class='x-badge'>타이밍</span> “~하는 동안(에)”",
      situation:"기회 있을 때 미리 해두기",
      breakdown:"暗くならないうちに + 帰る",
      caution:"‘ないうちに’가 특히 빈출(되기 전에)",
      variation:"若いうちに…／雨が降らないうちに…"
    },
    examples:[
      {jp:"暗くならないうちに帰りましょう。", pron:"쿠라쿠 나라나이 우치니 카에리마쇼오", ko:"어두워지기 전에 돌아가요.", use:"✅ 상황: 안전/타이밍", highlight:["うちに"]},
      {jp:"忘れないうちにメモします。", pron:"와스레나이 우치니 메모시마스", ko:"잊기 전에 메모할게요.", use:"✅ 상황: 예방", highlight:["うちに"]},
      {jp:"熱いうちに食べてください。", pron:"아츠이 우치니 타베테 쿠다사이", ko:"뜨거울 때 드세요.", use:"✅ 상황: 음식 타이밍", highlight:["うちに"]}
    ]
  },
  {
    cat:"time", tag:"시간/순서", title:"～たとたん(に) (…하자마자)",
    desc:"어떤 일을 하자마자 바로 (대개 예상 밖 사건)",
    rule:"동사た形 + <span class='hl'>とたん(に)</span>",
    warn:"바로 이어지는 사건(특히 예상 밖)이 포인트.",
    extra:{
      core:"<span class='x-badge'>즉시</span> “~하자마자”",
      situation:"문을 열자마자/앉자마자 등",
      breakdown:"出た + とたんに + 雨が降った",
      caution:"의지/계획 문장과는 잘 안 붙음(자연 발생 사건 쪽)",
      variation:"家を出たとたんに…"
    },
    examples:[
      {jp:"家を出たとたんに雨が降りました。", pron:"이에오 데타 토탄니 아메가 후리마시타", ko:"집을 나서자마자 비가 왔어요.", use:"✅ 상황: 바로 발생", highlight:["とたんに"]},
      {jp:"座ったとたん、眠くなりました。", pron:"스왓타 토탄, 네무쿠 나리마시타", ko:"앉자마자 졸려졌어요.", use:"✅ 상황: 즉시 변화", highlight:["とたん"]},
      {jp:"電気をつけたとたんに消えました。", pron:"덴키오 츠케타 토탄니 키에마시타", ko:"불을 켜자마자 꺼졌어요.", use:"✅ 상황: 예상 밖", highlight:["とたんに"]}
    ]
  },

  /* =======================
     condition: 조건/가정
  ======================= */
  /* ✅ 추가(조건/가정) */
  {
    cat:"condition", tag:"조건/가정", title:"～と (…하면/…하자 항상)",
    desc:"자연스러운 결과/규칙(하면 항상 그렇게 됨)",
    rule:"普通形 + <span class='hl'>と</span> + 결과",
    warn:"의지/명령/권유(～ましょう 등)와는 잘 안 섞임.",
    extra:{
      core:"<span class='x-badge'>규칙</span> “~하면(항상)”",
      situation:"기계/습관/자연현상 규칙",
      breakdown:"春になると + 暖かくなる",
      caution:"‘たら’는 개인 조건/약속도 가능, ‘と’는 규칙/자연 결과",
      variation:"ここを押すとドアが開きます。"
    },
    examples:[
      {jp:"このボタンを押すと、ドアが開きます。", pron:"코노 보탄오 오스토, 도아가 아키마스", ko:"이 버튼을 누르면 문이 열려요.", use:"✅ 상황: 기계/규칙", highlight:["と"]},
      {jp:"春になると暖かくなります。", pron:"하루니 나루토 아타타카쿠 나리마스", ko:"봄이 되면 따뜻해져요.", use:"✅ 상황: 자연 변화", highlight:["と"]},
      {jp:"甘いものを食べると元気になります。", pron:"아마이 모노오 타베루토 겡키니 나리마스", ko:"단 걸 먹으면 기운이 나요.", use:"✅ 상황: 일반 경향", highlight:["と"]}
    ]
  },
  {
    cat:"condition", tag:"조건/가정", title:"～ば～ほど (…하면 할수록)",
    desc:"비례(점점 더 ~해짐)",
    rule:"조건형(ば) + <span class='hl'>ほど</span>",
    warn:"정형 패턴으로 독해/문법에서 자주.",
    extra:{
      core:"<span class='x-badge'>비례</span> “~하면 할수록”",
      situation:"연습/시간/비용 증가에 따른 변화",
      breakdown:"勉強すればするほど + 上手になる",
      caution:"앞뒤 동사 반복 형태가 많음",
      variation:"見れば見るほど好きになる。"
    },
    examples:[
      {jp:"勉強すればするほど、日本語が上手になります。", pron:"벤쿄오스레바 스루호도, 니혼고가 조오즈니 나리마스", ko:"공부하면 할수록 일본어가 늘어요.", use:"✅ 상황: 실력 향상", highlight:["ば","ほど"]},
      {jp:"使えば使うほど、便利さが分かります。", pron:"츠카에바 츠카우호도, 벤리사가 와카리마스", ko:"쓰면 쓸수록 편리함을 알게 돼요.", use:"✅ 상황: 경험 누적", highlight:["ほど"]},
      {jp:"考えれば考えるほど、分からなくなります。", pron:"칸가에레바 칸가에루호도, 와카라나쿠 나리마스", ko:"생각하면 할수록 더 모르겠어요.", use:"✅ 상황: 복잡", highlight:["ほど"]}
    ]
  },

  /* =======================
     (추가) 경험/완료·준비 계열을 connect/time에 분산
  ======================= */
  {
    cat:"connect", tag:"연결/진행", title:"～てある (…해 두었다: 결과 상태)",
    desc:"누군가 해둔 결과가 ‘상태’로 남아 있음",
    rule:"타동사 て형 + <span class='hl'>あります</span>",
    warn:"‘ている’(진행/상태)와 유사하지만 ‘의도적으로 해둔 결과’ 느낌.",
    extra:{
      core:"<span class='x-badge'>결과상태</span> “~해져 있다(해두었다)”",
      situation:"준비/세팅된 상태 설명",
      breakdown:"窓が開けてあります(창문을 열어둠)",
      caution:"보통 타동사(열다, 놓다, 쓰다 등)가 잘 옴",
      variation:"名前が書いてあります。／資料が用意してあります。"
    },
    examples:[
      {jp:"机の上に資料が置いてあります。", pron:"츠쿠에노 우에니 시료오가 오이테아리마스", ko:"책상 위에 자료가 놓여 있어요(해두었음).", use:"✅ 상황: 준비 상태", highlight:["てあります"]},
      {jp:"ドアが開けてあります。", pron:"도아가 아케테아리마스", ko:"문이 열어져 있어요(열어둠).", use:"✅ 상황: 세팅", highlight:["てあります"]},
      {jp:"ここに名前が書いてあります。", pron:"코코니 나마에가 카이테아리마스", ko:"여기에 이름이 적혀 있어요(적어둠).", use:"✅ 상황: 표시", highlight:["てあります"]}
    ]
  },
  {
    cat:"connect", tag:"연결/진행", title:"～ておきます (미리 …해두다)",
    desc:"나중을 대비해 미리 준비",
    rule:"동사 て형 + <span class='hl'>おきます</span>",
    warn:"시험/여행/약속 전에 ‘미리’ 준비할 때 자주.",
    extra:{
      core:"<span class='x-badge'>준비</span> “미리 ~해두다”",
      situation:"나중을 위해 미리 해두는 행동",
      breakdown:"予約して + おきます",
      caution:"회화 줄임: ておく→とく(しとく)",
      variation:"切符を買っておきます。／調べておきます。"
    },
    examples:[
      {jp:"旅行の前にホテルを予約しておきます。", pron:"료코오노 마에니 호테루오 요야쿠시테 오키마스", ko:"여행 전에 호텔을 미리 예약해둘게요.", use:"✅ 상황: 준비", highlight:["ておきます"]},
      {jp:"分からない単語をメモしておきます。", pron:"와카라나이 탄고오 메모시테 오키마스", ko:"모르는 단어는 메모해둘게요.", use:"✅ 상황: 공부", highlight:["ておきます"]},
      {jp:"明日のために資料をコピーしておきます。", pron:"아시타노 타메니 시료오오 코피이시테 오키마스", ko:"내일을 위해 자료를 미리 복사해둘게요.", use:"✅ 상황: 업무", highlight:["ておきます"]}
    ]
  }
];

/* ==========================================================
  하이라이트/렌더 유틸
========================================================== */
function escapeHtml(s){
  return String(s)
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#39;");
}
function applyHighlight(jp, highlightArr){
  let safe = escapeHtml(jp);
  const hs = (highlightArr || []).filter(Boolean).sort((a,b)=>b.length-a.length);
  hs.forEach(h => {
    const hh = escapeHtml(h);
    safe = safe.split(hh).join(`<span class="hl">${hh}</span>`);
  });
  return safe;
}
function renderCard(item){
  const exHtml = (item.examples || []).map(ex => {
    const jpHtml = applyHighlight(ex.jp, ex.highlight);
    return `
      <div class="ex-row">
        <div class="ex-left">
          <div class="ex-jp">${jpHtml}</div>
          <div class="ex-pron">${escapeHtml(ex.pron || "")}</div>
          <div class="ex-ko">${escapeHtml(ex.ko || "")}</div>
          ${ex.use ? `<div class="ex-use">${escapeHtml(ex.use)}</div>` : ``}
        </div>
        <button class="tts-btn" type="button" data-tts="${escapeHtml(ex.jp)}">발음 듣기</button>
      </div>
    `;
  }).join("");

  const extra = item.extra || {};
  const extraHtml = `
    <div class="g-extra">
      <div class="x-row"><div class="x-k">핵심</div><div class="x-v">${extra.core || ""}</div></div>
      <div class="x-row"><div class="x-k">상황</div><div class="x-v">${escapeHtml(extra.situation || "")}</div></div>
      <div class="x-row"><div class="x-k">분해</div><div class="x-v">${escapeHtml(extra.breakdown || "")}</div></div>
      <div class="x-row"><div class="x-k">주의</div><div class="x-v">${escapeHtml(extra.caution || "")}</div></div>
      <div class="x-row"><div class="x-k">변형</div><div class="x-v">${escapeHtml(extra.variation || "")}</div></div>
    </div>
  `;

  return `
    <div class="g-card" data-cat="${escapeHtml(item.cat)}">
      <div class="g-head">
        <h3 class="g-title">${escapeHtml(item.title)}</h3>
        <div class="g-tag">${escapeHtml(item.tag || "")}</div>
      </div>
      <p class="g-desc"><b>의미:</b> ${escapeHtml(item.desc || "")}</p>
      <div class="g-rule"><b>접속:</b> ${item.rule || ""}</div>
      <div class="g-warn"><b>포인트:</b> ${escapeHtml(item.warn || "")}</div>
      ${extraHtml}
      <div class="ex">${exHtml}</div>
    </div>
  `;
}

/* 초기 렌더 */
(function init(){
  const root = document.getElementById("grammarList");
  root.innerHTML = grammarData.map(renderCard).join("");
})();

/* 칩 필터 */
(function(){
  const chips = Array.from(document.querySelectorAll('.jlpt-chip[data-filter]'));
  function setOn(btn){
    chips.forEach(c => c.classList.remove('is-on'));
    btn.classList.add('is-on');
  }
  function applyFilter(key){
    const cards = Array.from(document.querySelectorAll('#grammarList .g-card'));
    cards.forEach(card => {
      const cat = (card.getAttribute('data-cat') || '').trim();
      card.style.display = (key === 'all' || cat === key) ? '' : 'none';
    });
  }
  chips.forEach(btn => {
    btn.addEventListener('click', () => {
      const key = btn.getAttribute('data-filter');
      setOn(btn);
      applyFilter(key);
    });
  });
})();

/* TTS */
(function () {
  function pickJapaneseVoice() {
    const voices = window.speechSynthesis?.getVoices?.() || [];
    return (
      voices.find(v => v.lang === "ja-JP") ||
      voices.find(v => (v.lang || "").toLowerCase().startsWith("ja")) ||
      null
    );
  }

  function speakJP(text) {
    if (!window.speechSynthesis) return;

    window.speechSynthesis.cancel();
    let t = (text || "").trim();
    if (!t) return;
    if (t.length === 1) t = t + "。";

    const u = new SpeechSynthesisUtterance(t);
    u.lang = "ja-JP";
    u.volume = 1;
    u.rate = 0.95;
    u.pitch = 1;

    const v = pickJapaneseVoice();
    if (v) u.voice = v;

    window.speechSynthesis.speak(u);
  }

  try { window.speechSynthesis.getVoices(); } catch(e) {}

  document.addEventListener("click", function (e) {
    const btn = e.target.closest(".tts-btn[data-tts]");
    if (!btn) return;
    speakJP(btn.getAttribute("data-tts"));
  });
})();
</script>
{% endblock %}
